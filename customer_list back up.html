<!DOCTYPE html>
<html lang="th">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta charset="UTF-8">
  <title>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Prompt','Segoe UI',sans-serif;margin:0;background:#fff;padding:10px 10px 120px}
    .menu-bar{display:flex;justify-content:space-around;background:#fff;padding:10px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.05);margin-bottom:20px;position:sticky;top:0;z-index:1000}
    .menu-bar a{text-decoration:none;font-weight:bold;color:teal}

    table{width:95%;margin:20px auto;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.05)}
    th,td{border:1px solid #eee;padding:10px;text-align:left;font-size:12px;vertical-align:top}
    th{background:#e0f7fa;color:#00796b;cursor:pointer}
    tr:nth-child(even){background:#f9f9f9}
    tr:hover{background:#e0f2f1}
/* Modal */
#customer-modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  z-index:9999;
  align-items:center;
  justify-content:center;
}
#customer-modal .modal-box{
  background:#fff;
  padding:24px;
  border-radius:16px;
  max-width:90%;
  max-height:90vh;
  overflow-y:auto;
  position:relative;
  box-shadow:0 8px 30px rgba(0,0,0,.2);
  font-size:13px;
  line-height:1.6;
}
#modal-content h3{ font-size:16px; margin-bottom:8px; }

    .details ul{padding-left:20px;margin:0}
    .show-btn{padding:5px 10px;background:#0288d1;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:12px}
    #export-btn{display:block;margin:20px auto;background:#4caf50;color:#fff;padding:10px 20px;border:none;border-radius:8px;font-size:10px;font-weight:bold;cursor:pointer}
    .phone-toggle{padding:4px 8px;border-radius:8px;background:#e3f2fd;font-weight:bold;color:#0277bd;cursor:pointer}
    .details{display:flex;justify-content:flex-start;padding:0;margin:0;background:none;border:none}
    .detail-bar{display:inline-block;padding:1px 1px;margin:0;background:#e3f2fd;color:#0277bd;border-radius:14px;font-size:10px;font-weight:500;cursor:pointer}
    .detail-bar:hover{background:#bbdefb}
    td.note-col,td.keyword-col{font-size:12px;color:#444;line-height:1.4em}

    /* ‚ñº ‡πÅ‡∏ú‡∏á‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ */
    .diag-panel{width:95%;margin:24px auto 8px;background:#f7fffb;border:1px solid #bfeee3;border-radius:14px;padding:12px 12px 14px;box-shadow:0 2px 8px rgba(0,0,0,.04)}
    .diag-title{font-weight:800;color:#0b7660;margin:0 0 8px}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip-btn{border:1px solid #a7e1da;background:#fff;color:#0b7660;border-radius:999px;padding:8px 12px;font-size:12px;font-weight:700;cursor:pointer}
    .chip-btn:hover{background:#eaf9f6}
    #diag-count{margin-left:8px;color:#0b7660;font-size:12px}
    #diag-results{width:95%;margin:8px auto 20px;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.05)}
    #diag-results th,#diag-results td{border:1px solid #eee;padding:8px;font-size:12px}
    #diag-results thead tr{background:#f0fdfa}

    /* ‚ñº Floating Dock (‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°) */
    .floating-toggle {
    position: fixed;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%);
    width: 58px;
    height: 58px;
    background: rgba(0, 128, 128, 0);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    cursor: pointer;
  }
  .floating-menu {
    position: fixed;
    bottom: 90px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    border-radius: 16px;
    padding: 10px;
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    z-index: 999;
    max-height: 60vh;
    overflow-y: auto;
  }
  .floating-menu a img {
    width: 52px;
    height: 52px;
  }
  </style>
</head>
<body>


  <table>
    <thead>
      <tr>
        <th onclick="sortTable(0)">‡∏•‡∏≥‡∏î‡∏±‡∏ö ‚¨ç</th>
        <th onclick="sortTable(1)">OPD ‚¨ç</th>
        <th onclick="sortTable(2)">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‚¨ç</th>
        <th onclick="sortTable(3)">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ ‚¨ç</th>
        <th onclick="sortTable(4)">‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚¨ç</th>
        <th onclick="sortTable(5)">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó) ‚¨ç</th>
        <th onclick="sortTable(6)">‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å ‚¨ç</th>
        <th onclick="sortTable(7)">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ‚¨ç</th>
        <th onclick="sortTable(8)">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ã‡∏∑‡πâ‡∏≠ ‚¨ç</th>
      </tr>
    </thead>
    <tbody id="customer-table-body"></tbody>
  </table>

  <button id="export-btn">üßæ Export ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Excel</button>

  <!-- ‚ñº ‡πÅ‡∏ú‡∏á‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ -->
  <div class="diag-panel">
    <div class="diag-title">üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ <span id="diag-count"></span></div>
    <div class="chips">
      <button class="chip-btn" onclick="runDiag('missingPhone')">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</button>
      <button class="chip-btn" onclick="runDiag('nameDifferentOPD')">‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡πâ‡∏≥ (‡∏ï‡πà‡∏≤‡∏á OPD)</button>
      <button class="chip-btn" onclick="runDiag('phoneDifferentName')">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥ (‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠)</button>
      <button class="chip-btn" onclick="runDiag('opdDifferentNamePhone')">OPD ‡∏ã‡πâ‡∏≥ (‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå)</button>
      <button class="chip-btn" onclick="runDiag('invalidPhone')">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å</button>
      <button class="chip-btn" onclick="runDiag('invalidOPD')">OPD ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 4 ‡∏´‡∏•‡∏±‡∏Å</button>
      <button class="chip-btn" onclick="runDiag('splitGroups')">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏ï‡∏Å (‡∏ä‡∏∑‡πà‡∏≠+‡πÄ‡∏ö‡∏≠‡∏£‡πå+OPD ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)</button>
      <button class="chip-btn" onclick="runDiag('sameNameMultiPhones')">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå/‡∏ß‡πà‡∏≤‡∏á</button>
    </div>
  </div>

  <table id="diag-results" style="display:none;">
    <thead><tr id="diag-head"></tr></thead>
    <tbody id="diag-body"></tbody>
  </table>

  <script>
    let customers = [];
    let allSales = [];
    let sortState = {};

    // ---- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ customers + ‡πÄ‡∏Å‡πá‡∏ö allSales ----
    fetch("/api/sales")
      .then(res => res.json())
      .then(records => {
        allSales = records || [];

        const customerMap = {};
        records.forEach(rec => {
          const key = `${rec.name}|${rec.phone}`;
          if (!customerMap[key]) {
            customerMap[key] = {
              name: rec.name,
              phone: rec.phone || '-',
              opd: rec.opd || '',
              total: 0,
              lastDate: rec.date,
              note: rec.note || '',
              history: []
            };
          }
          customerMap[key].total += parseFloat(rec.amount) || 0;
          customerMap[key].history.push({
            date: rec.date,
            items: rec.items || [],
            amount: rec.amount,
            payment: rec.payment,
            note: rec.note
          });
          if (rec.date > customerMap[key].lastDate) {
            customerMap[key].note = rec.note || '';
            customerMap[key].lastDate = rec.date;
          }
        });

        customers = Object.values(customerMap).sort((a, b) => parseInt(a.opd) - parseInt(b.opd));
        const tableBody = document.getElementById('customer-table-body');

        customers.forEach((c, i) => {
          const row = document.createElement('tr');
          const daysAbsent = calcDaysAbsent(c.lastDate);
          const keywords = extractKeywordsFromHistory(c.history);
          row.innerHTML = `
            <td>${i + 1}</td>
            <td>${c.opd}</td>
            <td><span class="detail-bar" onclick="openCustomerModal(${i})">${c.name}</span></td>
            <td><span class="phone-toggle" data-phone="${c.phone}" onclick="togglePhone(this)">üìû</span></td>
            <td>${formatDate(c.lastDate)}</td>
            <td>${c.total.toLocaleString()}</td>
            <td>${daysAbsent}</td>
            <td class="note-col">${c.note || '-'}</td>
            <td class="keyword-col">${keywords || '-'}</td>
          `;
          tableBody.appendChild(row);
        });

        document.getElementById('export-btn').addEventListener('click', () => {
          const data = customers.map(c => ({
            ‡∏ä‡∏∑‡πà‡∏≠: c.name,
            OPD: c.opd,
            ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: c.phone,
            '‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠': formatDate(c.lastDate),
            '‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)': c.total
          }));
          const sheet = XLSX.utils.json_to_sheet(data);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(wb, sheet, '‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î');
          XLSX.writeFile(wb, '‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î.xlsx');
        });
      })
      .catch(err => {
        console.error("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å Supabase ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", err);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤");
      });

    // ---------- Utilities ----------
    function formatDate(d){ if(!d) return ''; const [y,m,day]=d.split('-'); return `${day}/${m}/${y.slice(-2)}`; }
    function calcDaysAbsent(lastDateStr){ const today=new Date(); const last=new Date(lastDateStr); return Math.floor((today-last)/(1000*60*60*24)); }
    function parseThaiDate(dateStr){ const p=dateStr.split('/'); if(p.length!==3) return new Date(0); const [d,m,y]=p; const full=parseInt(y)<50?2000+parseInt(y):1900+parseInt(y); return new Date(full, parseInt(m)-1, parseInt(d)); }
    function sortTable(colIndex){
      const tbody=document.getElementById("customer-table-body");
      const rows=Array.from(tbody.rows);
      const key=`col-${colIndex}`; sortState[key]=!sortState[key]; const dir=sortState[key]?1:-1;
      const sorted=rows.map(row=>{
        const t=row.cells[colIndex].textContent.trim();
        const isDate=(colIndex===4); const n=t.replace(/,/g,'');
        const v=isDate?parseThaiDate(t):(isNaN(n)?t.toLowerCase():parseFloat(n));
        return {row,value:v};
      }).sort((a,b)=>(a.value>b.value?1:a.value<b.value?-1:0)*dir);
      tbody.innerHTML=''; sorted.forEach(({row})=>tbody.appendChild(row));
    }
    function extractKeywordsFromHistory(history){
      const set=new Set();
      const keys=["Aestox","Allergan","‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î","‡πÅ‡∏ö‡πà‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß","Neuramis","E.P.T.Q","Restylane","Bromi","Sisi","HIFU","HIFU ‡πÅ‡∏ñ‡∏°","Meso Chanel","P - Cell","Aquatic","Hestina","Exosome","Rejuran","Belotero Revive","Sculptra","Juvelook","Aesthefill","PRP","Mesowink","‡∏™‡∏∞‡∏Å‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™","Alphaarbutin","Transamine","Snow White","Super Aurawhite","Vitamin Mix","Brain Booster","Energy Booster","‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™","‡∏™‡∏¥‡∏ß","‡∏ù‡πâ‡∏≤","‡∏ú‡∏•‡∏±‡∏Å‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô","‡∏õ‡∏±‡πà‡∏ô RF","‡∏Å‡∏î‡∏™‡∏¥‡∏ß","subcision‡∏™‡∏¥‡∏ß","‡∏¢‡∏≤‡∏â‡∏µ‡∏î‡∏™‡∏•‡∏≤‡∏¢‡∏ù‡πâ‡∏≤","‡∏Ñ‡∏£‡∏µ‡∏°‡∏ó‡∏≤‡∏ù‡πâ‡∏≤","‡∏¢‡∏≤‡∏ó‡∏≤‡∏ô‡∏ù‡πâ‡∏≤","‡πÑ‡∏´‡∏°‡∏•‡∏¥‡∏ü‡∏ó‡πå‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤","‡πÑ‡∏´‡∏° PDO","‡πÑ‡∏´‡∏° Collagen","‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô","‡∏à‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡∏™‡∏•‡∏≤‡∏¢‡∏ü‡∏¥‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå","PRP‡∏ú‡∏°","‡∏à‡∏µ‡πâ‡πÑ‡∏ù"];
      history.forEach(h=> (h.items||[]).forEach(s=> keys.forEach(k=> { if(String(s).toLowerCase().includes(k.toLowerCase())) set.add(k); })));
      return Array.from(set).join(', ');
    }
    function togglePhone(el){
      if(el.dataset.showing==="true"){ el.innerText="üìû"; el.dataset.showing="false"; }
      else{ el.innerText=el.dataset.phone; el.dataset.showing="true"; }
    }
    function safe(v){ const m={"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}; return (v==null?'':String(v)).replace(/[&<>"']/g, s=>m[s]); }

    // ---------- Modal & ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ----------
    const categoryMap = {
      "Botox": ["Aestox","Allergan","Botulax","Botox","Botox ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î","Nabota"],
      "Filler": ["Neuramis","E.P.T.Q","Restylane","Juvederm","Belotero","Belotero Revive"],
      "Fat Burn": ["Sisi","Bromi","Lipo V","Fat ‡∏¢‡∏Å‡πÅ‡∏Å‡πâ‡∏°","Fat ‡∏•‡∏î‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏á"],
      "Meso / ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™": ["Meso Chanel","P - Cell","Aquatic","Hestina","Exosome","Rejuran","PRP","Mesowink","‡∏™‡∏∞‡∏Å‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™","Alphaarbutin","Transamine","Snow White","Super Aurawhite","Vitamin Mix"],
      "Hair / PRP ‡∏ú‡∏°": ["PRP‡∏ú‡∏°","Meso ‡∏ú‡∏°","‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏°","‡∏™‡πÄ‡∏õ‡∏£‡∏¢‡πå‡∏ú‡∏°"],
      "HIFU / RF / ‡∏¢‡∏Å‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö": ["HIFU","HIFU ‡πÅ‡∏ñ‡∏°","HIFU ‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤","‡∏õ‡∏±‡πà‡∏ô RF","Ulthera"],
      "‡∏™‡∏¥‡∏ß / ‡∏ù‡πâ‡∏≤ / ‡∏¢‡∏≤ / ‡∏ú‡∏•‡∏±‡∏Å‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô": ["‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™","‡∏™‡∏¥‡∏ß","‡∏ù‡πâ‡∏≤","‡∏ú‡∏•‡∏±‡∏Å‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô","‡∏¢‡∏≤‡∏â‡∏µ‡∏î‡∏™‡∏•‡∏≤‡∏¢‡∏ù‡πâ‡∏≤","‡∏¢‡∏≤‡∏ó‡∏≤‡∏ô‡∏ù‡πâ‡∏≤","‡∏Ñ‡∏£‡∏µ‡∏°‡∏ó‡∏≤‡∏ù‡πâ‡∏≤","‡∏Å‡∏î‡∏™‡∏¥‡∏ß","subcision‡∏™‡∏¥‡∏ß"],
      "‡πÑ‡∏´‡∏°": ["‡πÑ‡∏´‡∏°‡∏•‡∏¥‡∏ü‡∏ó‡πå‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤","‡πÑ‡∏´‡∏° PDO","‡πÑ‡∏´‡∏° Collagen"],
      "‡∏≠‡∏∑‡πà‡∏ô‡πÜ": ["‡∏à‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô","‡∏™‡∏•‡∏≤‡∏¢‡∏ü‡∏¥‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå","‡∏à‡∏µ‡πâ‡πÑ‡∏ù","‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]
    };

    function openCustomerModal(index) {
      const customer = customers[index];
      const records = customer.history.map(h => ({...h, name: customer.name, phone: customer.phone, opd: customer.opd}));
      if (records.length === 0) return;

      const latestRecord = records.reduce((latest, r) => new Date(r.date) > new Date(latest.date) ? r : latest, records[0]);

      const lastDate = new Date(latestRecord.date);
      const daysAbsent = Math.floor((new Date() - lastDate) / (1000 * 60 * 60 * 24));
      const paidRecords = records.filter(r => parseFloat(r.amount || 0) > 0);
      const paidVisits = paidRecords.length;
      const totalAmount = paidRecords.reduce((sum, r) => sum + parseFloat(r.amount), 0);
      const average = paidVisits > 0 ? Math.round(totalAmount / paidVisits) : 0;

      const allItems = {};
      records.forEach(r => {
        (r.items || []).forEach(item => {
          let name = item;
          const match = item.match(/\((.*?)\)/);
          if (match) { name = match[1]; } else { name = item.split(" - ")[0]; }
          const qtyMatch = item.match(/- (\d+) ‡∏ä‡∏¥‡πâ‡∏ô/);
          const qty = qtyMatch ? parseInt(qtyMatch[1]) : 1;
          allItems[name] = (allItems[name] || 0) + qty;
        });
      });

      const categorizedItems = {};
      for (const [cat, names] of Object.entries(categoryMap)) {
        names.forEach(n => {
          if (allItems[n]) {
            if (!categorizedItems[cat]) categorizedItems[cat] = [];
            categorizedItems[cat].push(`${n} : ${allItems[n]}`);
            delete allItems[n];
          }
        });
      }
      if (Object.keys(allItems).length) {
        categorizedItems["‡∏≠‡∏∑‡πà‡∏ô‡πÜ"] = Object.entries(allItems).map(([name, qty]) => `${name} : ${qty}`);
      }

      const itemSummary = Object.entries(categorizedItems)
        .map(([cat, items]) => `<div style="margin-bottom:6px;"><strong>${cat}</strong>: ${items.join(" | ")}</div>`)
        .join("");

      const historyHtml = records
        .sort((a, b) => b.date.localeCompare(a.date))
        .map(r => {
          const items = (r.items || []).map(item => {
            let name = item;
            const match = item.match(/\((.*?)\)/);
            if (match) { name = match[1]; } else { name = item.split(" - ")[0]; }
            const qtyMatch = item.match(/- (\d+) ‡∏ä‡∏¥‡πâ‡∏ô/);
            const qty = qtyMatch ? parseInt(qtyMatch[1]) : 1;
            return `<li>${name} : ${qty}</li>`;
          }).join("");

          const noteText = r.note ? `<div style="margin-top:2px; font-style:italic; color:#444;">üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${r.note}</div>` : "";

          return `
            <div style="margin-bottom:16px;">
              <div style="margin-bottom:4px;font-weight:bold;">üìÖ ${formatDate(r.date)}</div>
              <ul style="padding-left:16px;margin:0;">${items}</ul>
              <div style="margin-top:4px;color:#00796b;">üíµ ‡∏¢‡∏≠‡∏î: ${parseFloat(r.amount || 0).toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
              ${noteText}
              <hr style="margin: 10px auto; border: 0; border-top: 1px dashed #999; width: 60%;">
            </div>
          `;
        }).join("");

      const daysAbsentText = `<span style="color:red;">(‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß: ${daysAbsent} ‡∏ß‡∏±‡∏ô)</span>`;

      document.getElementById("modal-content").innerHTML = `
        <div style="position:absolute; top:10px; right:10px; display:flex; gap:10px;">
          <button onclick="saveModalAsImage()" title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" style="background:white; border:none; border-radius:50%; width:36px; height:36px; box-shadow:0 2px 6px rgba(0,0,0,0.15); cursor:pointer; display:flex; align-items:center; justify-content:center;">üíæ</button>
          <button onclick="closeCustomerModal()" title="‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á" style="background:white; border:none; border-radius:50%; width:36px; height:36px; box-shadow:0 2px 6px rgba(0,0,0,0.15); cursor:pointer; display:flex; align-items:center; justify-content:center;">‚ùå</button>
        </div>

        <h3 style="font-size:18px;margin-bottom:4px;">üìá ${customer.name}</h3>
        <div>üÜî <strong>OPD:</strong> ${customer.opd}</div>
        <div>üìû <strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</strong> ${customer.phone}</div>
        <div>üìÖ <strong>‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> ${formatDate(latestRecord.date)} ${daysAbsentText}</div>
        <div style="color:#00796b;"><strong>üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°:</strong> ${totalAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
        <div>üîÅ ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£: ${records.length} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (${paidVisits} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô)</div>
        <div>üí≥ <strong>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á:</strong> ${average.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>

        <hr style="margin: 16px auto 8px; border: 0; border-top: 1px solid #ccc; width: 60%;">

        <div style="font-weight:bold;">üì¶ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</div>
        <div style="margin:6px 0 12px;">${itemSummary}</div>

        <hr style="margin: 16px auto 8px; border: 0; border-top: 1px solid #ccc; width: 60%;">

        <div style="font-weight:bold;margin-bottom:6px;">üõçÔ∏è ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á:</div>
        ${historyHtml}

        <div style="margin-top:10px;font-weight:bold;color:#b8860b;">üí∞ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${totalAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
      `;

      document.getElementById("customer-modal").style.display = "flex";
    }

    function saveModalAsImage() {
      const node = document.getElementById("modal-content");
      if (!node) { alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô modal"); return; }
      html2canvas(node, { scale: 2 }).then(canvas => {
        const dataUrl = canvas.toDataURL("image/jpeg", 0.95);
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        if (isIOS) {
          const previewArea = document.createElement("div");
          previewArea.style.marginTop = "20px";
          previewArea.innerHTML = `
            <div style="font-weight:bold; margin-bottom:6px;">‡πÅ‡∏ï‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ</div>
            <img src="${dataUrl}" style="width:100%; border:1px solid #ccc; border-radius:12px;">
          `;
          const existing = document.getElementById("modalImagePreview");
          if (existing) existing.remove();
          previewArea.id = "modalImagePreview";
          node.appendChild(previewArea);
        } else {
          const link = document.createElement("a");
          link.download = 'customer-info.jpg';
          link.href = dataUrl;
          link.click();
        }
      }).catch(error => {
        console.error("‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û");
      });
    }

    function closeCustomerModal(){ document.getElementById("customer-modal").style.display="none"; }

    // ---------- ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ ----------
    const normName = s => String(s||'').trim().toLowerCase().replace(/\s+/g,' ');
    const onlyDigits = s => String(s||'').replace(/\D/g,'');
    const normPhone = s => {
      let d = onlyDigits(s);
      if(d.startsWith('66') && d.length>=11) d = '0' + d.slice(-9);
      return d;
    };
    const normOPD = s => String(s||'').trim().padStart(4,'0');
    const isValidPhone = p => { const d = normPhone(p); return d.length===9 || d.length===10; };
    const isValidOPD = o => /^\d{4}$/.test(String(o||'').trim());

    function runDiag(type){
      if(!allSales.length){ alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à'); return; }
      const rows = diagCompute(type);
      renderDiag(type, rows);
    }

    function diagCompute(type){
      const out = [];
      const byName = new Map();
      const byPhone = new Map();
      const byOPD = new Map();
      const byTripletNorm = new Map();

      allSales.forEach(r=>{
        const nameN = normName(r.name);
        const phoneN = normPhone(r.phone);
        const opdN = normOPD(r.opd);

        if(!byName.has(nameN)) byName.set(nameN,{opds:new Set(),phones:new Set(),rows:[]});
        byName.get(nameN).opds.add(opdN); byName.get(nameN).phones.add(phoneN||''); byName.get(nameN).rows.push(r);

        if(phoneN){
          if(!byPhone.has(phoneN)) byPhone.set(phoneN,{names:new Set(),opds:new Set(),rows:[]});
          byPhone.get(phoneN).names.add(nameN); byPhone.get(phoneN).opds.add(opdN); byPhone.get(phoneN).rows.push(r);
        }

        if(!byOPD.has(opdN)) byOPD.set(opdN,{names:new Set(),phones:new Set(),rows:[]});
        byOPD.get(opdN).names.add(nameN); byOPD.get(opdN).phones.add(phoneN||''); byOPD.get(opdN).rows.push(r);

        const tripKey = `${nameN}|${phoneN}|${opdN}`;
        if(!byTripletNorm.has(tripKey)) byTripletNorm.set(tripKey,{rawKeys:new Set(),rows:[]});
        byTripletNorm.get(tripKey).rawKeys.add(`${(r.name||'').trim()}|${(r.phone||'').trim()}`);
        byTripletNorm.get(tripKey).rows.push(r);
      });

      switch(type){
        case 'missingPhone': {
          allSales.forEach(r=>{
            const d = normPhone(r.phone);
            if(!d){ out.push({name:r.name||'-',opd:normOPD(r.opd),phone:'-',date:r.date}); }
          });
          break;
        }
        case 'nameDifferentOPD': {
          byName.forEach((v, nameN)=>{
            const opds = Array.from(v.opds).filter(x=>x!=='0000' && x!=='');
            if(new Set(opds).size>1){
              out.push({
                name: v.rows[0]?.name || nameN,
                opds: Array.from(new Set(opds)).join(', '),
                phones: Array.from(v.phones).filter(Boolean).join(', '),
                count: v.rows.length
              });
            }
          });
          break;
        }
        case 'phoneDifferentName': {
          byPhone.forEach((v, phoneN)=>{
            if(!phoneN) return;
            if(v.names.size>1){
              out.push({
                phone: phoneN,
                names: Array.from(v.names).map(n=>v.rows.find(r=>normName(r.name)===n)?.name || n).join(', '),
                opds: Array.from(v.opds).join(', '),
                count: v.rows.length
              });
            }
          });
          break;
        }
        case 'opdDifferentNamePhone': {
          byOPD.forEach((v, opdN)=>{
            if(v.names.size>1 || (v.phones.size>1 && !v.phones.has(''))){
              out.push({
                opd: opdN,
                names: Array.from(v.names).map(n=>v.rows.find(r=>normName(r.name)===n)?.name || n).join(', '),
                phones: Array.from(v.phones).join(', '),
                count: v.rows.length
              });
            }
          });
          break;
        }
        case 'invalidPhone': {
          allSales.forEach(r=>{
            const d = normPhone(r.phone);
            if(d && !isValidPhone(d)){
              out.push({name:r.name||'-',opd:normOPD(r.opd),phone:r.phone||'-',date:r.date});
            }
          });
          break;
        }
        case 'invalidOPD': {
          allSales.forEach(r=>{
            if(!isValidOPD(String(r.opd||''))){
              out.push({name:r.name||'-',opd:r.opd||'',phone:r.phone||'-',date:r.date});
            }
          });
          break;
        }
        case 'splitGroups': {
          byTripletNorm.forEach((v, k)=>{
            if(v.rawKeys.size>1){
              const [nameN, phoneN, opdN] = k.split('|');
              out.push({
                name: v.rows[0]?.name || nameN,
                opd: opdN,
                phone: v.rows[0]?.phone || phoneN,
                variants: Array.from(v.rawKeys).join('  |  '),
                count: v.rows.length
              });
            }
          });
          break;
        }
        case 'sameNameMultiPhones': {
          byName.forEach((v, nameN)=>{
            const phones = Array.from(v.phones);
            const nonEmpty = phones.filter(p=>p);
            if(nonEmpty.length>1 || (nonEmpty.length>=1 && phones.includes(''))){
              out.push({
                name: v.rows[0]?.name || nameN,
                phones: phones.map(p=>p||'(‡∏ß‡πà‡∏≤‡∏á)').join(', '),
                opds: Array.from(v.opds).join(', '),
                count: v.rows.length
              });
            }
          });
          break;
        }
      }
      return out;
    }

    function renderDiag(type, rows){
      const head = document.getElementById('diag-head');
      const body = document.getElementById('diag-body');
      const table = document.getElementById('diag-results');
      const counter = document.getElementById('diag-count');

      const headersByType = {
        missingPhone: ['‡∏ä‡∏∑‡πà‡∏≠','OPD','‡πÄ‡∏ö‡∏≠‡∏£‡πå','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'],
        nameDifferentOPD: ['‡∏ä‡∏∑‡πà‡∏≠','OPDs','‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏û‡∏ö','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'],
        phoneDifferentName: ['‡πÄ‡∏ö‡∏≠‡∏£‡πå','‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏û‡∏ö','OPDs','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'],
        opdDifferentNamePhone: ['OPD','‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏û‡∏ö','‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏û‡∏ö','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'],
        invalidPhone: ['‡∏ä‡∏∑‡πà‡∏≠','OPD','‡πÄ‡∏ö‡∏≠‡∏£‡πå','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'],
        invalidOPD: ['‡∏ä‡∏∑‡πà‡∏≠','OPD (‡πÄ‡∏î‡∏¥‡∏°)','‡πÄ‡∏ö‡∏≠‡∏£‡πå','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'],
        splitGroups: ['‡∏ä‡∏∑‡πà‡∏≠','OPD','‡πÄ‡∏ö‡∏≠‡∏£‡πå','‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏û‡∏ö (name|phone)','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'],
        sameNameMultiPhones: ['‡∏ä‡∏∑‡πà‡∏≠','‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î','OPDs','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£']
      };

      const cols = headersByType[type] || ['‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'];
      head.innerHTML = cols.map(c=>`<th>${c}</th>`).join('');
      body.innerHTML = rows.map(r=>{
        switch(type){
          case 'missingPhone': return `<tr><td>${safe(r.name)}</td><td>${safe(r.opd)}</td><td style="color:#b91c1c">-</td><td>${formatDate(r.date)}</td></tr>`;
          case 'nameDifferentOPD': return `<tr><td>${safe(r.name)}</td><td>${safe(r.opds)}</td><td>${safe(r.phones||'-')}</td><td>${r.count}</td></tr>`;
          case 'phoneDifferentName': return `<tr><td>${safe(r.phone)}</td><td>${safe(r.names)}</td><td>${safe(r.opds)}</td><td>${r.count}</td></tr>`;
          case 'opdDifferentNamePhone': return `<tr><td>${safe(r.opd)}</td><td>${safe(r.names)}</td><td>${safe(r.phones)}</td><td>${r.count}</td></tr>`;
          case 'invalidPhone': return `<tr><td>${safe(r.name)}</td><td>${safe(r.opd)}</td><td style="color:#b91c1c">${safe(r.phone)}</td><td>${formatDate(r.date)}</td></tr>`;
          case 'invalidOPD': return `<tr><td>${safe(r.name)}</td><td style="color:#b91c1c">${safe(r.opd)}</td><td>${safe(r.phone)}</td><td>${formatDate(r.date)}</td></tr>`;
          case 'splitGroups': return `<tr><td>${safe(r.name)}</td><td>${safe(r.opd)}</td><td>${safe(r.phone)}</td><td>${safe(r.variants)}</td><td>${r.count}</td></tr>`;
          case 'sameNameMultiPhones': return `<tr><td>${safe(r.name)}</td><td>${safe(r.phones)}</td><td>${safe(r.opds)}</td><td>${r.count}</td></tr>`;
          default: return `<tr><td>‚Äî</td></tr>`;
        }
      }).join('');

      counter.textContent = rows.length ? `‡∏û‡∏ö ${rows.length} ‡πÄ‡∏Ñ‡∏™` : '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥';
      table.style.display = 'table';
      table.scrollIntoView({behavior:'smooth',block:'start'});
    }

    

    // ‡∏õ‡∏¥‡∏î modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á
    document.addEventListener("DOMContentLoaded", function () {
      const modal = document.getElementById("customer-modal");
      if (modal) {
        modal.addEventListener("click", function (event) {
          const modalBox = modal.querySelector(".modal-box");
          if (!modalBox.contains(event.target)) { closeCustomerModal(); }
        });
      }
    });


    function toggleFloatingMenu() {
    const menu = document.getElementById("floatingMenu");
    menu.style.display = (menu.style.display === "flex") ? "none" : "flex";
  }

  document.addEventListener('click', function(e) {
    const toggle = document.getElementById("floatingToggle");
    const menu = document.getElementById("floatingMenu");
    if (!toggle.contains(e.target) && !menu.contains(e.target)) {
      menu.style.display = "none";
    }
  });
  </script>

 <div id="floatingToggle" class="floating-toggle" onclick="toggleFloatingMenu()">
  <img src="{{ url_for('static', filename='icon/icon_menu_toggle.png') }}" alt="menu" style="width:60px;height:60px;">
</div>

<div id="floatingMenu" class="floating-menu">
  <a href="{{ url_for('dashboard') }}"><img src="{{ url_for('static', filename='icon/icon_dashboard.png') }}"></a>
  <a href="{{ url_for('sale_summary') }}"><img src="{{ url_for('static', filename='icon/icon_sale_summary.png') }}"></a>
  <a href="{{ url_for('record_sales') }}"><img src="{{ url_for('static', filename='icon/icon_record_sales.png') }}"></a>
  <a href="{{ url_for('customer_list') }}"><img src="{{ url_for('static', filename='icon/icon_customer_list.png') }}"></a>
  <a href="{{ url_for('record_customer') }}"><img src="{{ url_for('static', filename='icon/icon_customer_history.png') }}"></a>
  <a href="{{ url_for('oldsaledata') }}"><img src="{{ url_for('static', filename='icon/icon_old_customers.png') }}"></a>
  <a href="{{ url_for('inventory') }}"><img src="{{ url_for('static', filename='icon/icon_inventory.png') }}"></a>
  <a href="#"><img src="{{ url_for('static', filename='icon/icon_staff.png') }}"></a>
  <a href="{{ url_for('appointments') }}"><img src="{{ url_for('static', filename='icon/icon_appointments.png') }}"></a>
</div>
<div id="customer-modal">
  <div class="modal-box" role="dialog" aria-modal="true">
    <button onclick="closeCustomerModal()" title="‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á"
            style="position:absolute;top:10px;right:14px;font-size:20px;border:none;background:transparent;cursor:pointer">√ó</button>
    <div id="modal-content"></div>
  </div>
</div>
</body>
</html>
